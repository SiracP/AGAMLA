<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        
        <title>Agamla Anasayfa | #{userBean.tag}</title>
        <link href='resources/css/bootstrap.min.css' rel='stylesheet' type='text/css'/>
        <script src="https://kit.fontawesome.com/41f4fd74e6.js" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/ionicons@5.5.1/dist/ionicons.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>
       <link href="http://fonts.googleapis.com/css?family=Nunito:100italic,100,300italic,300,400italic,400,700italic,700,900italic,900" rel="stylesheet" type="text/css"/>
       <link href='resources/css/agamla-main.css' rel='stylesheet' type='text/css'/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css"/>
       
    </h:head>
    <h:body onload="init();">
        <div class="">
            <div class="row-main box row ">
                 <div class="left-Panel col-3 d-none d-md-block ">
                     <div class="stick-top">
                        <div class="marka">
                            AGAMLA
                        </div>
                        <div class="Menu">
                            <h:form>
                            <ul class="left-Panel-Menu">
                                <li>
                                    <h:commandLink action="home" class="left-Panel-Link left-Panel-Link-Selected"><i class="fas fa-home"></i>Anasayfa</h:commandLink>
                                </li>
                                <li>
                                     <h:commandLink action="messages.xhtml?faces-redirect=true" class="left-Panel-Link"><i class="fas fa-envelope"></i>Mesajlar</h:commandLink>
                                </li>
                                <li>
                                    <h:commandLink action="notifications.xhtml?faces-redirect=true" class="left-Panel-Link"><i class="fas fa-bell"></i>Bildirimler</h:commandLink>
                                </li>
                                <li>
                                    <h:commandLink action="profile.xhtml?faces-redirect=true" class="left-Panel-Link"><i class="fas fa-user-alt"></i>Profil</h:commandLink>
                                </li>
                                <li>
                                    <h:commandLink action="saves.xhtml?faces-redirect=true" class="left-Panel-Link"><i class="fas fa-save"></i>Kaydedilenler</h:commandLink>
                                </li>
                                <li>
                                    <h:commandLink action="settings.xhtml?faces-redirect=true" class="left-Panel-Link"><i class="fas fa-cog"></i>Ayarlar</h:commandLink>
                                </li>

                            </ul>
                            </h:form>
                        </div>
                    </div>
                    

                    <div class="cikisYap">
                        <div class="cikisYap-Foto">
                            <img width="40px"
                                 src="${userBean.profilePictureUri}"
                                 alt="profilResim" style="border-radius: 20px;"/>
                        </div>
                        <div class="cikisYap-Text">
                            <div class="cikisYap-Profil-Ismi">
                                ${userBean.firstName} #{userBean.lastName}
                            </div>
                            <div class="cikisYap-Profil-Username">
                                @#{userBean.tag}
                            </div>

                        </div>
                        <div class="cikisYap-Cikis">
                            ...
                        </div>

                    </div>
                
                </div>
                
            <!-->
            
            
                BURAYA RESPONSIVE OLDUĞUNDA SOL PANELİN YAZISIZ HALİ GELECEK
                css ile olursa ok yoksa yeni panel yaz.
            </!-->   
            <div class="main-Panel col-12 col-md-6">
                <div class="panel-Main-Agala">
                    <h:form>

                    <div class="panel-Agala">
                        <div class="panel-Agala-Foto">
                            <img width="60px"
                                 src="${userBean.profilePictureUri}"
                                 alt="profilResim" style="border-radius: 30px;"/>
                        </div>
                        <div class="panel-Agala-Text">
                            <p:inputTextarea rows="2" id="text" cols ="75"  styleClass="Agala-Text" pt:placeholder="Neler oluyor?"
                                  pt:maxlength="280" value="#{userBean.postContent}"></p:inputTextarea>
                            <!-->
                            <h:inputTextarea rows="2" id="text" class="Agala-Text" pt:placeholder="Neler oluyor?"
                                  pt:maxlength="200"></h:inputTextarea></!-->
                        </div>
                    </div>
                    <div class="panel-Agala-Gonder">
                        <div class="Agala-Secenekler">
                            <h:commandLink class="Agala-Sec"><i class="far fa-image"></i></h:commandLink>
                            <h:commandLink class="Agala-Sec"><i class="fas fa-video"></i></h:commandLink>
                            <c:if test="#{not empty userBean.postHata}">
                                <p style="color:red;margin:0;padding:0;">#{userBean.postHata}</p>
                             </c:if>
                        </div>
                        <h:commandButton class="btn btn-primary btn-agala" value="Agala" action="#{userBean.postGonder()}">
                        
                           
                        
                        
                        </h:commandButton>
                    </div>
                    </h:form>
                    <a>
                        <ion-icon name="share-outline"></ion-icon>
                    </a>
                    
                </div>
                <ui:repeat value="#{userBean.postlariGoster()}" var="item">
                    <h:form>
                    <div class="aga">
                    <div class="aga-Sol">
                        <img src="#{userBean.postUserPictureUri(item.userId)}"
                             width="60px" style="border-radius: 30px;" alt=""/>
                    </div>
                    <div class="aga-Main">
                        <div class="aga-Main-Ust">
                            <div class="aga-Main-Ust-Isim">
                                #{userBean.postUserFirstName(item.userId)} #{userBean.postUserLastName(item.userId)}
                            </div>
                            <div class="aga-Main-Ust-Kullanıcı" style="color:gray;">
                                @#{userBean.postUserTag(item.userId)}
                            </div>

                        </div>
                        <div class="aga-Main-Icerik">
                            
                            <p>#{item.content}</p>
                           
                            
                                
                                    
                                
                                <div class="aga-Main-Photo">
                                    
                                    <h:graphicImage rendered="#{item.photoUrl != null}">
                                        <img src="#{item.photoUrl}"
                                             width="100%" class="photo-Style photoPost" alt=""></img>
                                    </h:graphicImage>
                                    
                                    <div id="myModal" class="modal">
                                        <span class="close">&times;</span>
                                        <img class="modal-content" id="img01"/>
                                        <div id="caption"></div>
                                    </div>

                                </div>
                            

                        </div>
                        <div class="aga-Main-Action">
                            
                            <h:panelGroup id="begeniler">
                                
                            
                                 <div class="aga-Main-Action-Like" id="guncelle">
                                     <h:commandLink id="begenmemis" rendered="#{userBean.gonderiyiBegenmisMi(item.postId) eq 1}" class="aga-Main-Action-Like-Text" style="color:#0056b3;" action="#{userBean.gonderiyiBegenme(item.postId, item.likeCount)}">
                                         
                                         
                                         <i class="fas fa-heart"></i>&nbsp;#{item.likeCount}
                                         <f:ajax render="begeniler" />
                                     </h:commandLink>
                             
                                    
                                
                                     
                                    <h:commandLink  id="begenmis" rendered="#{userBean.gonderiyiBegenmemisMi(item.postId) eq 1}" class="aga-Main-Action-Like-Text"  action="#{userBean.gonderiyiBegen(item.postId, item.likeCount)}"><i class="far fa-heart"></i>&nbsp;#{item.likeCount}
                                    
                                    <f:ajax render="begeniler" />
                                    </h:commandLink>
                              
                            
                               </div>
                                 </h:panelGroup>
                            <div class="aga-Main-Action-Comment">
                                <h:commandLink class="aga-Main-Action-Comment-Text">
                                    <i class="far fa-comment"></i>&nbsp;#{item.commentCount}
                                </h:commandLink>
                                
                            </div>
                            <div class="aga-Main-Action-Share">
                                <h:commandLink>
                                    <i class="bi bi-share"></i>
                                </h:commandLink>
                                
                            </div>
                             <h:panelGroup id="kaydedilenler">
                            <div class="aga-Main-Action-Save">
                               
                                <h:commandLink rendered="#{userBean.gonderiyiKaydetmisMi(item.postId) eq 1}" class="aga-Main-Action-Save-Text" style="color:#0056b3;" action="#{userBean.gonderiyiKaydetme(item.postId)}"><i class="fas fa-save"></i>&nbsp;<f:ajax render="kaydedilenler" /></h:commandLink>
                             
                                    
                                
                                     
                                <h:commandLink rendered="#{userBean.gonderiyiKaydetmemisMi(item.postId) eq 1}" class="aga-Main-Action-Save-Text"  action="#{userBean.gonderiyiKaydet(item.postId)}"><i class="far fa-save"></i>&nbsp;<f:ajax render="kaydedilenler" /></h:commandLink>
                                
                            </div>
                            </h:panelGroup>
                            <h:commandLink class="aga-Main-Ust-Tarih">
                                #{item.createDate}
                            </h:commandLink>
                            

                        </div>


                    </div>
                   <div class="aga-Sag">
                        ...
                    </div>

                    </div>
                     </h:form>
                </ui:repeat>
                
                
                
                

            </div>
            <div class="right-Panel col-3 d-none d-md-block">
                <div class="stick-top">
                    <div class="search">
                        <h:form >

                            <h:inputText pt:required="required" class="search-input" pt:placeholder="Agalarını bul..." value="#{userBean.ara}"></h:inputText> <h:commandLink
                            action="#{userBean.aramaYap()}"
                            class="search-icon">
                                 <i class="fa fa-search"></i>
                               </h:commandLink>
                            <h:commandButton action="#{userBean.aramaYap()}" style="display:none;">
                                
                            </h:commandButton>
                        </h:form>
                    </div>
                    <div>
                        <h:form>
                            <ul class="right-Panel-menu">
                                <li> 
                                     <h:commandLink action="home" class="right-Panel-out-link">Hakkinda</h:commandLink>
                                </li>
                                <li> 
                                     <h:commandLink action="home" class="right-Panel-out-link">Hizmet Sartlari</h:commandLink>
                                </li>
                                <li> 
                                     <h:commandLink action="home" class="right-Panel-out-link">Iletisim</h:commandLink>
                                </li>
                                <li> 
                                     <h:commandLink action="home" class="right-Panel-out-link">2021 Agalar</h:commandLink>
                                </li>
                            </ul>

                        </h:form>
                    </div>
                </div>
                
            </div>
        </div>
            
    </div>
        <script>
         if(#{userBean.isLogged == false}){
                window.location.href="login.xhtml";
        }   
            
            var observe;
        if (window.attachEvent) {
            observe = function (element, event, handler) {
                element.attachEvent('on' + event, handler);
            };
        } else {
            observe = function (element, event, handler) {
                element.addEventListener(event, handler, false);
            };
        }

        function init() {
            var text = document.getElementById('text');

            function resize() {
                text.style.height = 'auto';
                text.style.height = text.scrollHeight + 'px';
            }

            /* 0-timeout to get the already changed text */
            function delayedResize() {
                window.setTimeout(resize, 0);
            }

            observe(text, 'change', resize);
            observe(text, 'cut', delayedResize);
            observe(text, 'paste', delayedResize);
            observe(text, 'drop', delayedResize);
            observe(text, 'keydown', delayedResize);

            text.focus();
            text.select();
            resize();
        }
        
         document.querySelectorAll('img.photoPost')
            .forEach((img) => {
                var modal = document.getElementById('myModal');


                var img = img;
                var modalImg = document.getElementById("img01");
                img.onclick = function () {
                    modal.style.display = "block";
                    modalImg.src = this.src;
                };

                var kapat = document.getElementsByClassName("close")[0];

                kapat.onclick = function () {
                    modal.style.display = "none";
                };
                window.onclick = function (event) {
                    if (event.target == modal) {
                        modal.style.display = "none";
                    }
                };
            });
        
            
        </script>
    </h:body>
</html>

